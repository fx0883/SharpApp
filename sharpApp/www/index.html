<html>
<head>	
<title>File System Example</title>
<meta charset="utf-8">
<script type="text/javascript" src="js/index.js"></script>


<script type="text/javascript">
            app.initialize();
</script>

<script src="http://localhost:8080/target/target-script-min.js#anonymous"></script>
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" charset="utf-8"> 

	// 等待加载PhoneGap
	
	document.addEventListener("deviceready", onDeviceReady, false); 
	
	// PhoneGap加载完毕
	
	function onDeviceReady() { 
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail); 
	}  
	
	function gotFS(fileSystem) { 
		fileSystem.root.getFile("data/1-1.txt", {create: true, exclusive: false}, gotFileEntry, fail); 
	}  
	
	function gotFileEntry(fileEntry) { 
		fileEntry.file(gotFile, fail); 
	}  
	
	function gotFile(file){ 

		readAsText(file); 
	}  
	
	function readDataUrl(file) { 
		var reader = new FileReader(); 
		reader.onloadend = function(evt) { 
			console.log("Read as data URL"); 
			console.log(evt.target.result); 
		}; 
		reader.readAsDataURL(file); 
	}  
	
	function readAsText(file) { 
		var reader = new FileReader(); 
		reader.onloadend = function(evt) { 
			console.log("Read as text1");
			console.log(evt.target.result);
            
            writeHtml(evt.target.result);

		}; 

        reader.readAsText(file);
	}

    function writeHtml(contextText)
    {
        var oDiv1  = document.getElementById("oDiv1");
        contextText = contextText.replace(/\r\n/ig,"<br/><br/>");
        oDiv1.innerHTML = contextText;
        //console.log(text22);
    }
	
    
    
	function fail(evt) { 
		console.log(evt.target.error.code); 
	}  

</script>
    
<script src="http://localhost:8080/target/target-script-min.js#anonymous"></script>

</head>
<body>
	<h1>Example</h1>
	<p>File System</p>
    
    <div ID="oDiv1">Div #1</div> 
</body>
</html>
